# .cliff.toml - Git Cliff config for Unity UPM package

[changelog]
# Header for the changelog (markdown)
header = """
# ğŸ“¦ Changelog

All notable changes to this package will be documented in this file.
"""

# Footer (optional)
footer = """
---
_This changelog was automatically generated using [git-cliff](https://github.com/orhun/git-cliff)._
"""

# Tag pattern: v1.2.3
tag_pattern = "^v[0-9]+\\.[0-9]+\\.[0-9]+$"

# Sorting
sort_commits = "desc"

# Group commits into sections
[[changelog.groups]]
title = "ğŸš€ Features"
regex = "^(feat|feature)(\\(.+\\))?:"

[[changelog.groups]]
title = "ğŸ› Bug Fixes"
regex = "^(fix)(\\(.+\\))?:"

[[changelog.groups]]
title = "ğŸ›  Improvements"
regex = "^(refactor|perf|style|improve)(\\(.+\\))?:"

[[changelog.groups]]
title = "ğŸ§ª Tests"
regex = "^test(\\(.+\\))?:"

[[changelog.groups]]
title = "ğŸ“š Documentation"
regex = "^docs(\\(.+\\))?:"

[[changelog.groups]]
title = "ğŸ”§ Maintenance"
regex = "^(chore|build|ci|meta)(\\(.+\\))?:"

[[changelog.groups]]
title = "ğŸ” Others"
regex = ".*"

# Optional: filter commits that should be skipped
[git]
# Exclude merge commits if not needed
exclude_merge_commits = true

# Template for each commit
commit_preprocessors = [
    { pattern = "\\(#([0-9]+)\\)", replace = "([#${1}](https://gitlab.local/${REPO}/-/merge_requests/${1}))" },
]

# Commit formatting
commit_parsers = [
    { message = "^feat", group = "ğŸš€ Features" },
    { message = "^fix", group = "ğŸ› Bug Fixes" },
    { message = "^refactor", group = "ğŸ›  Improvements" },
    { message = "^perf", group = "ğŸ›  Improvements" },
    { message = "^style", group = "ğŸ›  Improvements" },
    { message = "^test", group = "ğŸ§ª Tests" },
    { message = "^docs", group = "ğŸ“š Documentation" },
    { message = "^chore", group = "ğŸ”§ Maintenance" },
    { message = "^ci", group = "ğŸ”§ Maintenance" },
    { message = ".*", group = "ğŸ” Others" },
]

# Commit display format
[template]
# Example: - feat(UI): added new button
commit = "- {{message}}"

# Example: ## [1.2.3] - 2024-04-13
tag = "## [{{version}}] - {{timestamp | date(format=\"%Y-%m-%d\")}}"


[changelog]
header = "# Changelog"
body = """
{% if version %}## [{{ version }}] - {{ timestamp | date(format="%Y-%m-%d") }}
{% else %}## Unreleased
{% endif %}
{% for group, commits in commits | group_by(attribute="group") %}
### {{ group | upper_first }}

{% for commit in commits %}
- {{ commit.message | split(pat="\\n") | first }}{% endfor %}
{% endfor %}
"""
footer = ""

[git]
tag_pattern = "^v?[0-9]+\\.[0-9]+\\.[0-9]+$"
skip_unreleased = false
ignore_tag_error = true
filter_commits = true
commit_filters = [{ message = "^Merge", exclude = true }]

[commit_types]
feat = { group = "Features" }
fix = { group = "Bug Fixes" }
docs = { group = "Documentation" }
refactor = { group = "Refactoring" }
chore = { group = "Maintenance" }
test = { group = "Testing" }
ci = { group = "CI" }
perf = { group = "Performance" }
style = { group = "Style" }
